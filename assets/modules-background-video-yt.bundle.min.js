import{L as e}from"./shared-import-index.bundle.min.js";const i=function(){function e(){let e;e=THEMENAME||(theme.info.name?theme.info.name:"theme");const i=e.toLowerCase();this.options={rootMargin:"25% 0px 75% 0px"},this.callback=function(e,t){e.forEach((function(e){e.isIntersecting?e.target.dispatchEvent(new CustomEvent(`${i}:video-component:visible`,{bubbles:!1,cancelable:!1})):e.target.dispatchEvent(new CustomEvent(`${i}:video-component:not-visible`,{bubbles:!1,cancelable:!1}))}))},this._observedElementsCount=0}return e.prototype=Object.assign({},e.prototype,{_init:function(){"IntersectionObserver"in window&&(this._observer=new IntersectionObserver(this.callback,this.options))},_isInitialized:function(){return this._observedElementsCount>0},observe:function(e){try{this._isInitialized()||this._init(),this._observer.observe(e),this._observedElementsCount++}catch(e){console.error(e)}},unobserve:function(e){this._observer&&(this._observer.unobserve(e),this._observedElementsCount--,0===this._observedElementsCount&&this._deInit())},_deInit:function(){this._observer.disconnect()}}),e}(),t=[];document.addEventListener("alpine:init",(()=>{Alpine.data("ThemeModule_BackgroundVideoYT",(({videoType:s,videoId:o})=>({init(){s&&o?(this.componentId=this.$root.id,this.videoProvider=s,this.videoId=o,this.playerId=`player-${this.componentId}`,this.YTReady=!1,this.selectors={fallBackImage:"[data-fallback-image]",player:`#${this.playerId}`},this.classes={isPlaying:"is-playing",hidden:"hidden",errorElClass:"background-video__error",tallIframeClass:"background-video-iframe--tall"},this.eventHandlers={},Shopify.designMode&&document.addEventListener("shopify:section:unload",(e=>{e.target.contains(this.$root)&&this.deinit()})),this._init()):this._showFallBackImage()},_onPlayerStateChange(e){const i=t[this.playerId];1===e&&(this._hideFallBackImage(),this.$root.classList.add(this.classes.isPlaying)),-1===e&&(this.$root.classList.remove(this.classes.isPlaying),!0===i.didBuffer&&this._showFallBackImage()),3===e&&(i.didBuffer=!0)},_init(){"youtube"===this.videoProvider?"undefined"!=typeof YT?this._initYTVideo():(document.body.addEventListener("youtubeiframeapiready",(()=>{this._initYTVideo()})),e.load("youtubeSdk")):(this.htmlVideoEl=this.$root.querySelector("video"),this.htmlVideoEl.id=this.playerId,this._initVideoContainerObserver()),this.fallBackImageEl=this.$root.querySelector(this.selectors.fallBackImage),this.playerEl=this.$root.querySelector(this.selectors.player),this.eventHandlers.inView=this._inView.bind(this),this.eventHandlers.outOfView=this._outOfView.bind(this),this.$root.addEventListener("shapes:video-component:visible",this.eventHandlers.inView),this.$root.addEventListener("shapes:video-component:not-visible",this.eventHandlers.outOfView)},_showFallBackImage(){this.fallBackImageEl&&(this.fallBackImageEl.classList.remove(this.classes.hidden),this.playerEl&&this.playerEl.classList.add(this.classes.hidden))},_hideFallBackImage(){this.fallBackImageEl&&(this.fallBackImageEl.classList.add(this.classes.hidden),this.playerEl&&this.playerEl.classList.remove(this.classes.hidden))},_showErrorMessage(e){const i=this.$root.querySelector(`.${this.classes.errorElClass}`);null!==i&&i.remove();const t=document.createElement("div");t.classList.add(this.classes.errorElClass),t.innerText=e,this.$root.prepend(t)},_onYTPlayerError(e){let i="";switch(e.data){case 2:i="shapes Background Video: Invalid parameter value";break;case 100:i="shapes Background Video: Video not found";break;case 101:case 150:i="shapes Background Video: Video owner does not permit embedding";break;default:i="shapes Background Video: An error occurred"}""!==i&&(console.error(i),Shopify.designMode&&this._showErrorMessage(i)),Shopify.designMode||this._showFallBackImage()},_onYTPlayerReady(){!0===this.YTReady?this._play():(this.YTReady=!0,this._initResponsiveVideoContainer(),this._initVideoContainerObserver())},_initYTVideo(){t[this.playerId]=new YT.Player(this.playerId,{videoId:this.videoId,width:1280,height:720,events:{onError:function(e){this._onYTPlayerError(e)}.bind(this),onReady:function(e){this._onYTPlayerReady(e)}.bind(this),onStateChange:function(e){0===e.data&&e.target.seekTo(0),this._onPlayerStateChange(e.data)}.bind(this)},playerVars:{autohide:0,branding:0,cc_load_policy:0,controls:0,fs:0,iv_load_policy:3,modestbranding:1,playsinline:1,quality:"hd720",rel:0,showinfo:0,wmode:"opaque"}}),document.getElementById(this.playerId).setAttribute("tabindex","-1")},_inView(){this._play()},_outOfView(){this._pause()},_play(){if("youtube"===this.videoProvider){if(!0===this.YTReady){const e=t[this.playerId];e.mute(),e.playVideo()}}else this.htmlVideoEl.play()},_pause(){"youtube"===this.videoProvider?!0===this.YTReady&&t[this.playerId].pauseVideo():this.htmlVideoEl.pause()},_checkContainerSize(){const e=document.getElementById(this.playerId),i=(16/9).toFixed(2),t=(this.$root.clientWidth/this.$root.clientHeight).toFixed(2);if(e.classList.remove(this.classes.tallIframeClass),e.style.width="",e.style.left="",t<i){e.classList.add(this.classes.tallIframeClass);const s=(i/t*100).toFixed(2),o=(s-100)/2;e.style.width=`${s}%`,e.style.left=`-${o}%`}},_initResponsiveVideoContainer(){this._checkContainerSize(),this._debouncedCheckContainerSize=debounce(this._checkContainerSize.bind(this),300),window.addEventListener("resize",this._debouncedCheckContainerSize)},_initVideoContainerObserver(){void 0===window._videoComponentObserver&&(window._videoComponentObserver=new i),window._videoComponentObserver.observe(this.$root)},deinit(){window._videoComponentObserver.unobserve(this.$root),window.removeEventListener("resize",this._debouncedCheckContainerSize),this.$root.removeEventListener("shapes:video-component:visible",this.eventHandlers.inView),this.$root.removeEventListener("shapes:video-component:not-visible",this.eventHandlers.outOfView),window.removeEventListener("resize",this._debouncedCheckContainerSize),t[this.playerId].destroy()}})))}));
